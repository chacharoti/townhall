= link_to (image_tag @organization.banner.desktop, id: 'organization_banner'), root_url(subdomain: @organization.slug)

.container#voting.voting
  .banner_container
    .banner_img
  .voting-container
    .question
      .row
        .col-xs-12
          .right-col
            .row
              .col-md-11
                %h1= @question.title
            / .share-icon.desktop
          .left-col
            .img
              = image_tag @question.question_image.desktop, id: 'question_image'
            .voting-info.desktop
              .col-xs-6.text-right
                .row= days_left(@question.end_date)
              .col-xs-6.text-left
                .row= pluralize(@question.votes.count, 'Vote')
          .right-col
            .question-content
              = @question.description
            
            %hr
            %h3 Choose your top three flavours
            .note
              Make your selection by tapping the boxes below in order of your choice.
            =  form_for Vote.new, url: organization_question_votes_path(@question) do |f|
              = f.hidden_field :reason_ids

              %ul.ranking-list
                = render partial: 'questions/rankings/item', collection: @question.rankable_items

              .row
                .col-md-10.col-md-offset-2
                  .row
                    .col-md-6
                      = link_to 'Clear', '#', class: 'btn btn-block btn-clear'
                    .col-md-6
                      = f.submit 'Submit', class: 'btn btn-block btn-submit'

    = render partial: 'questions/footer', locals: { question: @question }

:javascript
  $(document).ready(function() {
    var ordered_items = [];

    $('input.css-checkbox').on('click', function(e) {
      var item_id = e.target.id;
      
      if ($.inArray ( item_id, ordered_items ) > -1 ) { 
        ordered_items.splice( $.inArray(item_id, ordered_items), 1 );
        $('input:checkbox').removeAttr('checked');
      }
      else {
        ordered_items.push(item_id) 
      }

      $('#vote_reason_ids').val( ordered_items.join(',') );
    });

    $('.btn-clear').click(function() {
      clear_all();
      return false;
    })

    function clear_all() {
      $('.checkboxHandler').removeClass('active');
      $('.checkboxHandler span').text('');
      $('input:checkbox').removeAttr('checked');
      ordered_items = [];
    }
  });
- if session[:voted]
  :javascript
    $(document).ready(function() {
      vote = '"#{session[:voted]}"';
      $('input[value=' + vote +']').prop('checked', true);
      $('form').submit();
    })
